TIMER EQU 10H
PIC EQU 20H
PIO EQU 30H
N_CLK EQU 10

ORG 40
IP_CLK DW RUT_CLK

ORG 1000H
VALOR DB 1

RUT_CLK: PUSH AX
CMP DH, 1
JZ REVERSA 
CMP DL, 8
JZ REINICIAR
CMP VALOR, 1
JNZ ROTARIZQ
MOV AL, VALOR
OUT PIO+1, AL
MOV BX, 1
MOV CL, VALOR
CALL ROTI
INC DL
JMP FIN
ROTARIZQ:MOV AL, VALOR
OUT PIO+1, AL 
MOV BX, 1
MOV CL, VALOR
CMP DL ,7
JNZ ET
INC DL
JMP FIN
ET: CALL ROTI
INC DL
JMP FIN
REINICIAR: MOV DH, 1
MOV DL, 0
JMP FIN 
REVERSA: CMP VALOR, 1
JNZ ROTARDER
MOV AL, VALOR 
OUT PIO+1, AL
MOV AL,  0FFH
OUT PIC+1, AL
JMP FIN
ROTARDER: CALL ROTD
MOV AL, VALOR
OUT PIO+1, AL
FIN: MOV AL, 0
OUT TIMER, AL
MOV AL, 20H
OUT PIC, AL
POP AX
IRET 

ROTI:     CMP   BX, 0
          JZ    FINT
          ADD   CL, CL
          ADC   CL, 0
          DEC   BX
          JNZ   ROTI
FINT: MOV VALOR, CL
      RET

ROTD:     MOV   BX, 7
          MOV CL ,VALOR
          CALL  ROTI
FINAL:    RET




ORG 2000H
CLI
MOV AL, 0FDH
OUT PIC+1, AL
MOV AL, N_CLK
OUT PIC+5, AL
MOV AL, 1
OUT TIMER+1, AL
MOV AL,0
OUT PIO+3,AL
OUT PIO+1, AL
OUT TIMER, AL
MOV DX, 0
MOV CL, 0
STI 
LAZO: JMP LAZO
END
